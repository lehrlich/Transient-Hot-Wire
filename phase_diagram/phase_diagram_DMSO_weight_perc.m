%phase_diagram_DMSO_weight_perc

clear all
clc

wp6 = 44.96;
wp5 = 37.72; %weight percent of 5M DMSO
wp4 = 30.39;
wp3 = 22.95;
wp2 = 15.41;
wp1 = 7.75;

D=[
1.6e-1, -1.8e-1
3.9e-1, -1.8e-1
6.2e-1, -1.9e-1
8.5e-1, -1.9e-1
1.1, -1.9e-1
1.3, -1.9e-1
1.5, -1.9e-1
1.8, -1.9e-1
2.0, -1.9e-1
2.2, -1.9e-1
2.5, -1.9e-1
2.7, -1.9e-1
2.9, -1.9e-1
3.1, -1.9e-1
3.4, -1.9e-1
3.6, -2.0e-1
3.8, -2.0e-1
4.1, -2.0e-1
4.3, -2.0e-1
4.5, -2.0e-1
4.8, -2.0e-1
5.0, -2.0e-1
5.2, -4.3e-1
5.5, -4.3e-1
5.7, -6.6e-1
5.9, -6.6e-1
6.1, -6.7e-1
6.4, -6.7e-1
6.6, -6.7e-1
6.8, -6.7e-1
7.1, -9.0e-1
7.3, -9.0e-1
7.5, -1.1
7.8, -1.1
8.0, -1.1
8.2, -1.1
8.4, -1.4
8.7, -1.4
8.9, -1.6
9.1, -1.6
9.4, -1.8
9.6, -1.8
9.8, -2.1
10.1, -2.1
10.3, -2.3
10.5, -2.3
10.8, -2.5
11.0, -2.5
11.2, -2.5
11.4, -2.5
11.7, -2.5
11.9, -2.5
12.1, -2.8
12.4, -2.8
12.6, -3.0
12.8, -3.0
13.1, -3.0
13.3, -3.0
13.5, -3.2
13.7, -3.2
14.0, -3.2
14.2, -3.2
14.4, -3.2
14.7, -3.2
14.9, -3.5
15.1, -3.5
15.4, -3.7
15.6, -3.7
15.8, -3.7
16.1, -3.7
16.3, -3.9
16.5, -3.9
16.7, -4.2
17.0, -4.2
17.2, -4.4
17.4, -4.4
17.7, -4.6
17.7, -4.9
17.9, -5.1
18.1, -5.1
18.4, -5.1
18.6, -5.1
18.8, -5.1
19.0, -5.1
19.3, -5.3
19.5, -5.3
19.7, -5.6
19.7, -5.8
20.0, -6.0
20.2, -6.0
20.4, -6.3
20.7, -6.3
20.9, -6.5
21.1, -6.5
21.4, -6.7
21.4, -6.9
21.6, -7.2
21.8, -7.2
22.0, -7.4
22.3, -7.4
22.5, -7.6
22.7, -7.6
23.0, -7.9
23.0, -8.1
23.2, -8.3
23.4, -8.3
23.7, -8.6
23.9, -8.6
24.1, -8.8
24.4, -8.8
24.6, -9.0
24.8, -9.0
25.0, -9.3
25.3, -9.3
25.5, -9.5
25.7, -9.5
26.0, -9.7
26.0, -10.0
26.2, -10.2
26.4, -10.2
26.7, -10.4
26.7, -10.7
26.9, -10.9
27.1, -10.9
27.4, -11.1
27.6, -11.1
27.8, -11.4
28.0, -11.4
28.3, -11.6
28.5, -11.6
28.7, -11.8
28.7, -12.0
29.0, -12.3
29.2, -12.3
29.4, -12.5
29.4, -12.7
29.7, -13.0
29.9, -13.0
30.1, -13.2
30.1, -13.4
30.4, -13.7
30.4, -13.9
30.6, -14.1
30.8, -14.1
31.0, -14.4
31.3, -14.4
31.5, -14.6
31.7, -14.6
32.0, -14.8
32.2, -14.8
32.4, -15.1
32.7, -15.1
32.9, -15.3
33.1, -15.3
33.3, -15.5
33.3, -15.8
33.6, -16.0
33.8, -16.0
34.0, -16.2
34.0, -16.4
34.3, -16.7
34.5, -16.7
34.7, -16.9
34.7, -17.1
35.0, -17.4
35.0, -17.6
35.2, -17.8
35.2, -18.1
35.4, -18.3
35.4, -18.5
35.7, -18.8
35.7, -19.0
35.9, -19.2
36.1, -19.2
36.3, -19.5
36.4, -19.7
36.6, -19.9
36.8, -19.9
37.0, -20.1
37.0, -20.4
37.3, -20.6
37.3, -20.8
37.3, -21.1
37.3, -21.3
37.5, -21.5
37.5, -21.8
37.7, -22.0
37.7, -22.2
38.0, -22.5
38.0, -22.7
38.2, -22.9
38.2, -23.2
38.4, -23.4
38.4, -23.6
38.7, -23.8
38.9, -23.8
39.1, -24.1
39.1, -24.3
39.4, -24.5
39.4, -24.8
39.6, -25.0
39.6, -25.2
39.8, -25.5
40.0, -25.5
40.3, -25.7
40.3, -25.9
40.5, -26.2
40.5, -26.4
40.7, -26.6
40.7, -26.9
41.0, -27.1
41.0, -27.3
41.2, -27.5
41.4, -27.5
41.7, -27.8
41.7, -28.0
41.9, -28.2
42.1, -28.2
42.4, -28.5
42.4, -28.7
42.4, -28.9
42.4, -29.2
42.6, -29.4
42.6, -29.6
42.8, -29.9
42.8, -30.1
43.0, -30.3
43.1, -30.5
43.3, -30.8
43.3, -31.0
43.5, -31.2
43.5, -31.5
43.5, -31.7
43.5, -31.9
43.7, -32.2
43.7, -32.4
44.0, -32.6
44.0, -32.9
44.2, -33.1
44.2, -33.3
44.4, -33.6
44.4, -33.8
44.4, -34.0
44.4, -34.2
44.7, -34.5
44.7, -34.7
44.9, -34.9
45.1, -34.9
45.4, -35.2
45.4, -35.4
45.6, -35.6
45.8, -35.6
46.1, -35.9
46.1, -36.1
46.1, -36.3
46.1, -36.6
46.3, -36.8
46.3, -37.0
46.5, -37.3
46.5, -37.5
46.5, -37.7
46.5, -37.9
46.5, -38.2
46.5, -38.4
46.8, -38.6
46.8, -38.9
46.8, -39.1
46.8, -39.3
47.0, -39.6
47.0, -39.8
47.2, -40.0
47.2, -40.3
47.4, -40.5
47.4, -40.7
47.7, -40.9
47.7, -41.2
47.9, -41.4
48.1, -41.4
48.4, -41.4
48.4, -41.6
48.6, -41.9
48.6, -42.1
48.6, -42.3
48.6, -42.6
48.6, -42.8
48.6, -43.0
48.6, -43.3
48.6, -43.5
48.8, -43.7
48.8, -43.9
49.1, -44.2
49.1, -44.4
49.1, -44.6
49.1, -44.9
49.3, -45.1
49.3, -45.3
49.5, -45.6
49.5, -45.8
49.8, -46.0
49.8, -46.3
49.8, -46.5
49.8, -46.7
50.0, -47.0
50.0, -47.2
50.0, -47.4
50.0, -47.6
50.2, -47.9
50.2, -48.1
50.2, -48.3
50.2, -48.6
50.5, -48.8
50.5, -49.0
50.7, -49.3
50.7, -49.5
50.9, -49.7
50.9, -50.0
51.2, -50.2
51.2, -50.4
51.4, -50.6
51.4, -50.9
51.4, -51.1
51.4, -51.3
51.6, -51.6
51.6, -51.8
51.6, -52.0
51.6, -52.3
51.8, -52.5
51.8, -52.7
51.8, -53.0
51.8, -53.2
52.1, -53.4
52.1, -53.6
52.3, -53.9
52.3, -54.1
52.3, -54.3
52.3, -54.6
52.3, -54.8
52.3, -55.0
52.5, -55.3
52.5, -55.5
52.5, -55.7
52.5, -56.0
52.5, -56.2
52.5, -56.4
52.8, -56.6
52.8, -56.9
52.8, -57.1
52.8, -57.3
53.0, -57.6
53.0, -57.8
53.2, -58.0
53.2, -58.3
53.5, -58.5
53.5, -58.7
53.7, -59.0
53.7, -59.2
53.7, -59.4
53.7, -59.6
53.9, -59.9
53.9, -60.1
54.2, -60.3
54.2, -60.6
54.2, -60.8
54.2, -61.0
54.2, -61.3
54.2, -61.5
54.4, -61.7
54.4, -62.0
54.4, -62.2
54.4, -62.4
54.6, -62.7
54.6, -62.9
54.9, -63.1
];
Dw = D;
for j = 1:100
    Dw(:,1) = smooth(Dw(:,1));
    Dw(:,2) = smooth(Dw(:,2));
    j = j+1;
end

%plot(Dw(:,1),Dw(:,2))
%hold on
P=polyfit(Dw(:,1),Dw(:,2),4);
%plot(Dw(:,1),polyval(P,Dw(:,1)),'-r')

T_i = polyval(P,wp6);
Z=2;
for Z=2:T_i+63
    T(1)=T_i;
    T(Z)=T_i-Z+1;
    syms x
    x = sym('x','real');
    P_x = P(1)*x^4+P(2)*x^3+P(3)*x^2+P(4)*x+P(5);
    P_x = P_x -T(Z); 
    [G] = double( solve(P_x, x) );
    V(Z)=G(1,1);
end
T(Z+1)=-63;
V(Z+1)=V(Z);
C=(V-wp6)./V;
D=T;
S=(V-wp6)./V;
S(1)=0;
C(1)=0;
T2=linspace(-63,-160);
T1=linspace(20,T_i);
S2=linspace(1,1);
S1=linspace(0,0);
S=horzcat(S1,S,S2);
T=horzcat(T1,T,T2);
figure(2)
plot(T,S,'-y','LineWidth',3);
hold on
save phase_diagram_DMSO_6M
clearvars -except P D Dw wp6 wp5 wp4 wp3 wp2 wp1

T_i = polyval(P,wp5);
Z=2;
for Z=2:T_i+63
    T(1)=T_i;
    T(Z)=T_i-Z+1;
    syms x
    x = sym('x','real');
    P_x = P(1)*x^4+P(2)*x^3+P(3)*x^2+P(4)*x+P(5);
    P_x = P_x -T(Z); 
    [G] = double( solve(P_x, x) );
    V(Z)=G(1,1);
end
T(Z+1)=-63;
V(Z+1)=V(Z);
C=(V-wp5)./V;
D=T;
S=(V-wp5)./V;
S(1)=0;
C(1)=0;
T2=linspace(-63,-160);
T1=linspace(20,T_i);
S2=linspace(1,1);
S1=linspace(0,0);
S=horzcat(S1,S,S2);
T=horzcat(T1,T,T2);
figure(2)
plot(T,S,'-g','LineWidth',3);

save phase_diagram_DMSO_5M
clearvars -except P D Dw wp6 wp5 wp4 wp3 wp2 wp1

T_i = polyval(P,wp4);
Z=2;
for Z=2:T_i+63
    T(1)=T_i;
    T(Z)=T_i-Z+1;
    syms x
    x = sym('x','real');
    P_x = P(1)*x^4+P(2)*x^3+P(3)*x^2+P(4)*x+P(5);
    P_x = P_x -T(Z); 
    [G] = double( solve(P_x, x) );
    V(Z)=G(1,1);
end
T(Z+1)=-63;
V(Z+1)=V(Z);
C=(V-wp4)./V;
D=T;
S=(V-wp4)./V;
S(1)=0;
C(1)=0;
T2=linspace(-63,-160);
T1=linspace(20,T_i);
S2=linspace(1,1);
S1=linspace(0,0);
S=horzcat(S1,S,S2);
T=horzcat(T1,T,T2);
figure(2)
plot(T,S,'-r','LineWidth',3);

save phase_diagram_DMSO_4M
clearvars -except P D Dw wp6 wp5 wp4 wp3 wp2 wp1

T_i = polyval(P,wp3);
Z=2;
for Z=2:T_i+63
    T(1)=T_i;
    T(Z)=T_i-Z+1;
    syms x
    x = sym('x','real');
    P_x = P(1)*x^4+P(2)*x^3+P(3)*x^2+P(4)*x+P(5);
    P_x = P_x -T(Z); 
    [G] = double( solve(P_x, x) );
    V(Z)=G(1,1);
end
T(Z+1)=-63;
V(Z+1)=V(Z);
C=(V-wp3)./V;
D=T;
S=(V-wp3)./V;
S(1)=0;
C(1)=0;
T2=linspace(-63,-160);
T1=linspace(20,T_i);
S2=linspace(1,1);
S1=linspace(0,0);
S=horzcat(S1,S,S2);
T=horzcat(T1,T,T2);
figure(2)
plot(T,S,'-b','LineWidth',3);

save phase_diagram_DMSO_3M
clearvars -except P D Dw wp6 wp5 wp4 wp3 wp2 wp1

T_i = polyval(P,wp2);
Z=2;
for Z=2:T_i+63
    T(1)=T_i;
    T(Z)=T_i-Z+1;
    syms x
    x = sym('x','real');
    P_x = P(1)*x^4+P(2)*x^3+P(3)*x^2+P(4)*x+P(5);
    P_x = P_x -T(Z); 
    [G] = double( solve(P_x, x) );
    V(Z)=G(1,1);
end
T(Z+1)=-63;
V(Z+1)=V(Z);
C=(V-wp2)./V;
D=T;
S=(V-wp2)./V;
S(1)=0;
C(1)=0;
T2=linspace(-63,-160);
T1=linspace(20,T_i);
S2=linspace(1,1);
S1=linspace(0,0);
S=horzcat(S1,S,S2);
T=horzcat(T1,T,T2);
figure(2)
plot(T,S,'-c','LineWidth',3);

save phase_diagram_DMSO_2M
clearvars -except P D Dw wp6 wp5 wp4 wp3 wp2 wp1

T_i = polyval(P,wp1);
Z=2;
for Z=2:T_i+63
    T(1)=T_i;
    T(Z)=T_i-Z+1;
    syms x
    x = sym('x','real');
    P_x = P(1)*x^4+P(2)*x^3+P(3)*x^2+P(4)*x+P(5);
    P_x = P_x -T(Z); 
    [G] = double( solve(P_x, x) );
    V(Z)=G(1,1);
end
T(Z+1)=-63;
V(Z+1)=V(Z);
C=(V-wp1)./V;
D=T;
S=(V-wp1)./V;
S(1)=0;
C(1)=0;
T2=linspace(-63,-160);
T1=linspace(20,T_i);
S2=linspace(1,1);
S1=linspace(0,0);
S=horzcat(S1,S,S2);
T=horzcat(T1,T,T2);
figure(2)
plot(T,S,'-m','LineWidth',3);

save phase_diagram_DMSO_1M
clearvars -except P D Dw wp6 wp5 wp4 wp3 wp2 wp1


